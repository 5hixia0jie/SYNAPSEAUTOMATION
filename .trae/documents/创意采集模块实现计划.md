# 创意采集模块需求文档

## 一、项目概述

**创意采集模块**是一个用于从头条和抖音平台采集视频创意信息的功能模块，包括视频标题、标签、封面、原视频链接等信息，并通过AI技术生成拍摄脚本，为用户提供创意参考和内容创作辅助。

## 二、功能需求

### 2.1 前端功能

| 功能点 | 描述 | 详细要求 |
|-------|------|----------|
| 新增菜单 | 在系统菜单中添加"创意采集"菜单 | 位置：在"素材管理"前面<br>图标：使用合适的图标表示创意采集功能 |
| 创意采集页面 | 展示采集处理的信息 | 展示内容：标题、标签、封面、拍摄脚本、原视频链接<br>布局：卡片式布局，支持分页和筛选<br>交互：支持查看详情、删除操作 |
| 手动采集功能 | 提供手动输入视频链接进行采集的功能 | 触发方式：页面右上角的"手动采集"按钮<br>交互：点击后弹窗，输入视频链接<br>反馈：显示采集进度和结果 |
| 风格统一 | 保持与现有系统风格一致 | 遵循现有系统的设计规范和视觉风格<br>使用相同的UI组件库和样式 |

### 2.2 后端功能

| 功能点 | 描述 | 详细要求 |
|-------|------|----------|
| 爬虫服务 | 使用爬虫技术访问视频链接 | 支持平台：头条、抖音<br>技术选型：使用Playwright或类似爬虫框架<br>功能：模拟浏览器行为，处理动态加载内容 |
| 信息采集 | 采集视频相关信息 | 采集内容：标题、标签、封面图片、原视频链接<br>数据处理：清洗和标准化采集的数据 |
| 字幕处理 | 下载和处理视频字幕 | 功能：自动识别和下载视频字幕<br>处理：使用大模型重新编排生成拍摄脚本 |
| 数据存储 | 保存采集的信息 | 存储方式：本地数据库存储<br>数据结构：包含所有采集的字段和生成的脚本 |
| API接口 | 提供前端调用的接口 | 接口功能：提交采集任务、获取采集列表、获取详情、删除记录 |

## 三、技术需求

### 3.1 前端技术

| 技术 | 版本/说明 | 用途 |
|------|----------|------|
| Next.js | 13+ | 前端框架，使用App Router |
| React | 18+ | UI库 |
| Tailwind CSS | 3+ | 样式框架 |
| TypeScript | 5+ | 类型系统 |
| Lucide React | 最新版 | 图标库 |
| React Query | 最新版 | 数据获取和状态管理 |

### 3.2 后端技术

| 技术 | 版本/说明 | 用途 |
|------|----------|------|
| FastAPI | 0.100+ | 后端API框架 |
| Python | 3.9+ | 编程语言 |
| Playwright | 最新版 | 爬虫工具 |
| SQLAlchemy | 2.0+ | ORM框架 |
| Redis | 7.0+ | 缓存和任务队列 |
| AI模型 | 支持文本生成 | 用于生成拍摄脚本 |

## 四、数据需求

### 4.1 数据模型

**创意采集表**

| 字段名 | 数据类型 | 描述 |
|-------|---------|------|
| id | Integer | 主键ID |
| title | String | 视频标题 |
| tags | JSON | 视频标签（数组） |
| cover_url | String | 封面图片URL |
| video_url | String | 原视频链接 |
| script | Text | AI生成的拍摄脚本 |
| source_platform | String | 视频来源平台（头条/抖音） |
| status | String | 采集状态（成功/失败） |
| error_message | Text | 错误信息（如果失败） |
| created_at | DateTime | 创建时间 |
| updated_at | DateTime | 更新时间 |

### 4.2 数据流程

1. **采集流程**：用户输入视频链接 → 后端接收请求 → 爬虫访问链接 → 采集信息 → 下载字幕 → AI生成脚本 → 保存数据 → 返回结果

2. **展示流程**：前端请求采集列表 → 后端查询数据库 → 返回数据 → 前端展示 → 用户查看详情

## 五、API接口设计

| 接口路径 | 方法 | 功能描述 | 请求参数 | 成功响应 |
|---------|------|----------|---------|----------|
| `/api/v1/creative-collection/collect` | POST | 提交采集任务 | `{"video_url": "视频链接"}` | `{"success": true, "data": {"task_id": "任务ID"}}` |
| `/api/v1/creative-collection/list` | GET | 获取采集列表 | `page`, `page_size`, `filters` | `{"success": true, "data": {"items": [...], "total": 100}}` |
| `/api/v1/creative-collection/{id}` | GET | 获取采集详情 | `id` (路径参数) | `{"success": true, "data": {...}}` |
| `/api/v1/creative-collection/{id}` | DELETE | 删除采集记录 | `id` (路径参数) | `{"success": true}` |
| `/api/v1/creative-collection/status/{task_id}` | GET | 获取采集任务状态 | `task_id` (路径参数) | `{"success": true, "data": {"status": "处理中", "progress": 50}}` |

## 六、实现计划

### 6.1 前端实现

1. **修改菜单结构**
   * 在 `sidebar-new.tsx` 中添加"创意采集"菜单
   * 位置：在"素材管理"前面

2. **创建创意采集页面**
   * 实现页面布局和数据展示
   * 添加手动采集按钮和弹窗
   * 实现数据列表和详情查看

3. **实现API调用**
   * 封装API请求函数
   * 实现数据获取和状态管理
   * 添加错误处理和加载状态

### 6.2 后端实现

1. **创建API路由**
   * 实现创意采集相关的API端点
   * 添加请求验证和错误处理

2. **实现爬虫服务**
   * 开发头条和抖音的爬虫
   * 实现信息采集和字幕下载
   * 添加反爬措施和错误处理

3. **实现AI脚本生成**
   * 集成AI模型服务
   * 实现字幕处理和脚本生成
   * 优化生成结果

4. **实现数据存储**
   * 设计数据库模型
   * 实现数据存储和查询
   * 添加数据验证和清理

### 6.3 测试和优化

1. **功能测试**
   * 测试前端界面和交互
   * 测试后端API和爬虫功能
   * 测试AI脚本生成效果

2. **性能优化**
   * 优化爬虫性能和稳定性
   * 优化API响应速度
   * 优化前端渲染性能

3. **错误处理**
   * 添加详细的错误日志
   * 实现友好的错误提示
   * 处理边界情况和异常场景

## 七、验收标准

1. **功能完整性**：所有功能点均已实现，符合需求文档要求
2. **界面美观**：前端界面美观、易用，与现有系统风格一致
3. **性能稳定**：爬虫服务稳定运行，API响应及时
4. **数据准确**：采集的数据准确完整，脚本生成质量良好
5. **错误处理**：系统能够正确处理各种错误情况，给出合理的错误提示

## 八、风险评估

| 风险点 | 可能性 | 影响 | 应对措施 |
|-------|--------|------|----------|
| 爬虫被反爬 | 高 | 无法采集数据 | 使用代理IP、随机UA、模拟真实浏览器行为 |
| 平台页面结构变化 | 中 | 爬虫失效 | 定期维护爬虫，添加适配机制 |
| AI模型生成质量 | 中 | 脚本质量不佳 | 优化提示词，选择合适的模型，添加人工审核机制 |
| 数据存储容量 | 低 | 存储不足 | 实现数据清理机制，支持数据导出 |

## 九、依赖项

| 依赖项 | 版本/说明 | 用途 |
|-------|----------|------|
| Playwright | 最新版 | 爬虫工具 |
| FastAPI | 0.100+ | 后端API框架 |
| SQLAlchemy | 2.0+ | ORM框架 |
| Redis | 7.0+ | 缓存和任务队列 |
| AI模型服务 | 支持文本生成 | 脚本生成 |
| Next.js | 13+ | 前端框架 |
| Tailwind CSS | 3+ | 样式框架 |

## 十、总结

创意采集模块将为用户提供一个便捷的工具，用于从头条和抖音平台采集视频创意信息，并通过AI技术生成拍摄脚本，帮助用户快速获取创意灵感和创作参考。该模块的实现将丰富系统功能，提高用户的内容创作效率。